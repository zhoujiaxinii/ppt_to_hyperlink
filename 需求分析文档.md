# PPT文件超链接转换功能需求分析文档

## 1. 引言

本文档旨在详细记录用户对PPT文件超链接转换功能的需求，包括初始需求、迭代需求以及最终实现的功能细节。该功能的核心目标是自动化处理PPTX文件中的特定链接，并提供便捷的API接口进行访问。

## 2. 初始需求

用户最初的需求是解析提供的PPTX文件，提取其中的音频和视频链接，并将其转换为可点击的超链接格式。同时，用户希望了解实现此功能所使用的技术栈。

**原始PPT文件：** `汉语拼音声调：一声初体验(5).pptx`

**核心功能点：**
*   解析PPTX文件内容。
*   识别并提取PPTX中嵌入的音频和视频链接。
*   将提取到的链接转换为可点击的超链接形式。
*   提供技术栈分析报告。

## 3. 迭代需求

在完成初始需求并提供初步的超链接转换结果后，用户提出了两个新的、更具体的需求，以扩展功能并优化部署方式。

### 3.1 需求一：游戏链接转换

用户要求功能能够识别并转换PPT中包含的特定游戏链接为超链接。该游戏链接的特征是一个以`.json`结尾的HTTPS链接，通常作为`data_url`参数出现在一个HTML页面链接中。

**示例游戏链接：** `https://courseware-1302261367.file.myqcloud.com/package/re_qi_qiu_you_xi_8/index.html?data_url=https://courseware1302261367.file.myqcloud.com/json/%E6%95%99%E7%A0%94/doom_the_rescue_20250811095444.json`

### 3.2 需求二：腾讯云COS上传与API部署

用户要求处理完成的PPT文件能够自动上传到腾讯云对象存储（COS），并返回COS上的文件链接。同时，用户希望将此功能封装成一个API服务，部署在服务器上，以便通过API进行访问。

**腾讯云COS信息：**
*   **存储桶名称：** `your-bucket-name`
*   **地域：** `your-region` (例如: ap-nanjing)
*   **访问密钥：** `SecretId: YOUR_SECRET_ID`；`SecretKey: YOUR_SECRET_KEY`

**API部署要求：**
*   **服务器环境：** Linux
*   **部署方式：** Docker容器化部署
*   **API认证：** 无需API认证
*   **域名/IP和端口：** 由代理人决定

**测试文件：** `ppt游戏链接.pptx`

## 4. 最终实现功能

根据上述需求，最终实现的功能是一个基于Flask框架的RESTful API服务，它能够接收PPTX文件的下载链接，自动完成链接转换和COS上传，并返回处理后的文件在COS上的下载链接。

**核心功能：**
1.  **PPTX文件下载：** API接收一个PPTX文件的URL，并使用`requests`库下载该文件。
2.  **链接提取：** 解压PPTX文件，遍历其XML内容，使用正则表达式识别并提取媒体链接（`.mp3`, `.mp4`等）和特定格式的游戏链接（`index.html?data_url=...json`）。
3.  **超链接转换：** 使用`python-pptx`库加载PPTX文件，遍历所有文本框中的段落和文本运行。如果文本运行中包含提取到的链接，则将其转换为可点击的超链接。
4.  **腾讯云COS上传：** 使用`qcloud-cos-python-sdk-v5`库将处理后的PPTX文件上传到指定的腾讯云COS存储桶。
5.  **返回COS链接：** API返回一个JSON响应，其中包含处理成功消息和COS上处理后文件的下载URL。
6.  **Docker部署：** 整个API服务通过Docker容器进行部署，确保环境一致性和可移植性。

## 5. 总结

该功能通过Python、Flask、python-pptx、requests、qcloud-cos-python-sdk-v5和Docker等技术栈的组合，成功实现了PPT文件中媒体和游戏链接的自动化超链接转换及云存储上传。API接口的提供使得用户可以通过编程方式便捷地使用此功能，大大提高了工作效率。

